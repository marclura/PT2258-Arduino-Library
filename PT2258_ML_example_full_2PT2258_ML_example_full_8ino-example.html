<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PT2258 Arduino Library: PT2258_ML_example_full/PT2258_ML_example_full.ino</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PT2258 Arduino Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('PT2258_ML_example_full_2PT2258_ML_example_full_8ino-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">PT2258_ML_example_full/PT2258_ML_example_full.ino</div></div>
</div><!--header-->
<div class="contents">
<p >PT2258-Arduino-Library example</p>
<div class="fragment"><div class="line">/*</div>
<div class="line">  @file PT2258_ML_example_full.ino</div>
<div class="line"> </div>
<div class="line">  This library is to control the 6-Channel Electronic Volume Controller IC PT2258</div>
<div class="line"> </div>
<div class="line">  PT2258 address</div>
<div class="line">  ----------------------------------------------------------------------------------</div>
<div class="line"> </div>
<div class="line">  (1: connected to VCC, 0: connected to GND)</div>
<div class="line"> </div>
<div class="line">  | CODE1 | CODE2 | ADDRESS 8bit | ADDRESS 7bit |</div>
<div class="line">  |   0   |   0   |    0x80      |    0x40      |</div>
<div class="line">  |   1   |   0   |    0x88      |    0x44      |</div>
<div class="line">  |   0   |   1   |    0x84      |    0x42      |</div>
<div class="line">  |   1   |   1   |    0x8C      |    0x46      |</div>
<div class="line"> </div>
<div class="line">  The Wire library uses addresses with 7bit, so if you perform an I2C scan,</div>
<div class="line">  the address will appear as right-shifted form the one specified</div>
<div class="line">  above and in the data sheet.</div>
<div class="line">  Example: I2C scan finds 0x44 -&gt; this means that the PT2258 has the address 0x88</div>
<div class="line"> </div>
<div class="line">  The default address used by the library is 0x88.</div>
<div class="line"> </div>
<div class="line">  If you need to change it, crete the PT2258 object like this:</div>
<div class="line"> </div>
<div class="line">  PT2258 pt2258(address); // where the address is a 8bit address (check the table for conversion)</div>
<div class="line"> </div>
<div class="line">  Example: PT2258 pt2258(0x84);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  Wire connection</div>
<div class="line">  ----------------------------------------------------------------------------------</div>
<div class="line">  The PT2258 is specified to work with a bus clock speed of 100kHz max.</div>
<div class="line"> </div>
<div class="line">  Add Wire.setClock(100000); in the sutup before calling the begin() funtion for</div>
<div class="line">  the PT2258.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  Mute</div>
<div class="line">  ----------------------------------------------------------------------------------</div>
<div class="line">  The PT2258 has the mute on all the channels activated by default when it does power</div>
<div class="line">  up as a safety measure.</div>
<div class="line"> </div>
<div class="line">  When the mute is active, even if the volume is changed, the channels will remain silent.</div>
<div class="line"> </div>
<div class="line">  Remember to deactivate the mute to ear the sound.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  Initial volume</div>
<div class="line">  ----------------------------------------------------------------------------------</div>
<div class="line">  The PT2258 has the volume of all the channels at the maximum when it powers on (and the mute</div>
<div class="line">  active as well, see &quot;Mute&quot; above).</div>
<div class="line"> </div>
<div class="line">  ----------------------------------------------------------------------------------</div>
<div class="line">  Created by Marco Lurati, April 21, 2023</div>
<div class="line">  </div>
<div class="line">  MIT License</div>
<div class="line"> </div>
<div class="line">  Copyright (c) 2023 marclura</div>
<div class="line"> </div>
<div class="line">  Permission is hereby granted, free of charge, to any person obtaining a copy</div>
<div class="line">  of this software and associated documentation files (the &quot;Software&quot;), to deal</div>
<div class="line">  in the Software without restriction, including without limitation the rights</div>
<div class="line">  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</div>
<div class="line">  copies of the Software, and to permit persons to whom the Software is</div>
<div class="line">  furnished to do so, subject to the following conditions:</div>
<div class="line"> </div>
<div class="line">  The above copyright notice and this permission notice shall be included in all</div>
<div class="line">  copies or substantial portions of the Software.</div>
<div class="line"> </div>
<div class="line">  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</div>
<div class="line">  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</div>
<div class="line">  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</div>
<div class="line">  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</div>
<div class="line">  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</div>
<div class="line">  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</div>
<div class="line">  SOFTWARE.</div>
<div class="line"> </div>
<div class="line">*/</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#include &lt;PT2258.h&gt;</div>
<div class="line">#include &lt;Wire.h&gt;</div>
<div class="line"> </div>
<div class="line">// If the address is different from the default 0x88, use this declaration PT2258 pt2258(address);</div>
<div class="line">// where the address corresponds to the 8bit address, so for example 0x84</div>
<div class="line">PT2258 pt2258(0x88);</div>
<div class="line"> </div>
<div class="line">int _delay(50); // &quot;speed&quot; of the volume and attenuation ramps</div>
<div class="line"> </div>
<div class="line">void setup() {</div>
<div class="line"> </div>
<div class="line">  Serial.begin(115200); // start the Serial communication</div>
<div class="line"> </div>
<div class="line">  Wire.begin(); // start the I2C bus</div>
<div class="line">  //Wire.setClock(100000);  // the PT2258 is specified to work with a bus clock of 100kHz</div>
<div class="line"> </div>
<div class="line">  if(!pt2258.begin()) { // initialise the PT2258</div>
<div class="line">    Serial.println(&quot;PT2258: connection error!&quot;);</div>
<div class="line">    while(1) delay(10);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  pt2258.volumeAll(0);  // at the beginning the volume is by default at 100%. Set the desired volume at startup before unmuting next</div>
<div class="line"> </div>
<div class="line">  pt2258.mute(false); // the mute is active when the device powers up. Unmute it to ear the sound</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line"> </div>
<div class="line">  singleChannelsIncreaseVol();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  decreaseVolAll();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  singleChannelsDecreseAttenuation();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  increaseAttenuationAll();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  toggleMute();</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">void singleChannelsIncreaseVol() {</div>
<div class="line"> </div>
<div class="line">  // Set volume all to zero</div>
<div class="line">  Serial.println(&quot;Volume all channels to 0 ...&quot;);</div>
<div class="line">  pt2258.volumeAll(0);</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  // Increase the volume of every channel individually and in sequence one after the other</div>
<div class="line">  Serial.println(&quot;increase the volume of every channel individually and in sequence one after the other ...&quot;);</div>
<div class="line"> </div>
<div class="line">  for(byte ch = 1; ch &lt;= 6; ch++) { // sequence of the channels one after the other</div>
<div class="line"> </div>
<div class="line">    Serial.print(&quot;Channel: &quot;);</div>
<div class="line">    Serial.println(ch);</div>
<div class="line"> </div>
<div class="line">    for(byte vol = 0; vol &lt;= 100; vol++) {   // gradually increase the volume form 0 to 100</div>
<div class="line">      pt2258.volume(ch, vol);</div>
<div class="line">      delay(_delay);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">void decreaseVolAll() {</div>
<div class="line"> </div>
<div class="line">  // Set volume all to max</div>
<div class="line">  Serial.println(&quot;Volume all channels to max...&quot;);</div>
<div class="line">  pt2258.volumeAll(100);</div>
<div class="line"> </div>
<div class="line">  // Decrease the volume of all the channels together</div>
<div class="line">  Serial.println(&quot;decrease the volume of all the channels together...&quot;);</div>
<div class="line"> </div>
<div class="line">  for(byte vol = 100; vol &gt; 0; vol--) { // gradually decrease the volume form 100 to 0</div>
<div class="line">    pt2258.volumeAll(vol);</div>
<div class="line">    delay(_delay);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void singleChannelsDecreseAttenuation() {</div>
<div class="line"> </div>
<div class="line">  // attenuation to max</div>
<div class="line">  pt2258.attenuationAll(79);  // attenuation goes from 0 (0db, no attenuation) to 79 (79db of attenuation, volume is minimum, to zero)</div>
<div class="line"> </div>
<div class="line">  // Decrease the attenuation of every channel individually and in sequence one after the other</div>
<div class="line">  Serial.println(&quot;decrease the attenuation of every channel individually and in sequence one after the other ...&quot;);</div>
<div class="line"> </div>
<div class="line">  for(byte ch = 1; ch &lt;= 6; ch++) { // sequence of the channels one after the other</div>
<div class="line"> </div>
<div class="line">    Serial.print(&quot;Channel: &quot;);</div>
<div class="line">    Serial.println(ch);</div>
<div class="line"> </div>
<div class="line">    for(byte att = 79; att &gt; 0; att--) {   // gradually reduce the attenuation from -79db to 0db</div>
<div class="line">      pt2258.attenuation(ch, att);</div>
<div class="line">      delay(_delay);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">void increaseAttenuationAll() {</div>
<div class="line"> </div>
<div class="line">  // attenuation to min</div>
<div class="line">  pt2258.attenuationAll(0);  // attenuation goes from 0 (0db, no attenuation, maxiumum volume) to 79 (79db of attenuation, volume is minimum, to zero)</div>
<div class="line"> </div>
<div class="line">  // Increase the attenuation of all the channels together</div>
<div class="line">  Serial.println(&quot;increase the attenuation of all the channels together ...&quot;);</div>
<div class="line"> </div>
<div class="line">  for(byte att = 0; att &lt;= 79; att++) { // gradually decrease the volume form 100 to 0</div>
<div class="line">    pt2258.attenuationAll(att);</div>
<div class="line">    delay(_delay);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">void toggleMute() {</div>
<div class="line"> </div>
<div class="line">  // Set volume all at 80%</div>
<div class="line">  Serial.println(&quot;Volume all channels 80% ...&quot;);</div>
<div class="line"> </div>
<div class="line">  pt2258.volumeAll(80);</div>
<div class="line">  delay(2000);</div>
<div class="line"> </div>
<div class="line">  // mute all</div>
<div class="line">  Serial.println(&quot;Mute all ...&quot;);</div>
<div class="line"> </div>
<div class="line">  pt2258.mute(true);</div>
<div class="line">  delay(2000);</div>
<div class="line"> </div>
<div class="line">  // unmute all</div>
<div class="line">  Serial.println(&quot;Unmute all ...&quot;);</div>
<div class="line"> </div>
<div class="line">  pt2258.mute(false);</div>
<div class="line">  delay(2000);</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
